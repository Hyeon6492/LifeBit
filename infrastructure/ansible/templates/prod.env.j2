# LifeBit 프로덕션 환경 변수
# 생성 시간: {{ ansible_date_time.iso8601 }}

# 데이터베이스 설정
POSTGRES_DB={{ postgres_db | default('lifebit_db') }}
POSTGRES_USER={{ postgres_user | default('lifebit_user') }}
POSTGRES_PASSWORD={{ postgres_password | default('lifebit_password_prod_' + ansible_date_time.epoch) }}

# 도메인 설정
DOMAIN_NAME={{ domain_name | default(ansible_host) }}

# OpenAI API 설정
OPENAI_API_KEY={{ openai_api_key | default('') }}
USE_GPT={{ use_gpt | default('False') }}

# 소셜 로그인 설정
VITE_GOOGLE_CLIENT_ID={{ google_client_id | default('') }}
VITE_KAKAO_CLIENT_ID={{ kakao_client_id | default('') }}

# JWT 설정
JWT_SECRET={{ jwt_secret | default('lifebit_jwt_secret_' + ansible_date_time.epoch) }}
JWT_ALGORITHM={{ jwt_algorithm | default('HS256') }}

# CORS 설정 (Core API용)
CORS_ORIGINS=http://{{ DOMAIN_NAME }},http://{{ DOMAIN_NAME }}:80,http://{{ DOMAIN_NAME }}:3000,https://{{ DOMAIN_NAME }}

# CORS 설정 (AI API용)
CORS_ALLOWED_ORIGINS=http://{{ DOMAIN_NAME }},http://{{ DOMAIN_NAME }}:80,http://{{ DOMAIN_NAME }}:3000,https://{{ DOMAIN_NAME }}

# 카카오/구글 리다이렉트 URI
KAKAO_REDIRECT_URI={{ kakao_redirect_uri | default('http://' + DOMAIN_NAME + ':3000/auth/kakao/callback') }}
GOOGLE_REDIRECT_URI={{ google_redirect_uri | default('http://' + DOMAIN_NAME + ':3000/auth/google/callback') }}

# 로깅 설정
LOG_LEVEL={{ log_level | default('info') }}

# 프로덕션 플래그
NODE_ENV=production
SPRING_PROFILES_ACTIVE=production

# Spring Boot 데이터베이스 설정
SPRING_DATASOURCE_URL=jdbc:postgresql://postgres-db:5432/{{ postgres_db | default('lifebit_db') }}?stringtype=unspecified&connectTimeout=30&socketTimeout=60&loginTimeout=30&ApplicationName=LifeBit-Core-API
SPRING_DATASOURCE_USERNAME={{ postgres_user | default('lifebit_user') }}
SPRING_DATASOURCE_PASSWORD={{ postgres_password | default('lifebit_password_prod_' + ansible_date_time.epoch) }}
SPRING_JPA_HIBERNATE_DDL_AUTO=validate
SPRING_JPA_SHOW_SQL=false
SPRING_JPA_DATABASE_PLATFORM=org.hibernate.dialect.PostgreSQLDialect
SPRING_DATASOURCE_DRIVER_CLASS_NAME=org.postgresql.Driver
SPRING_JPA_PROPERTIES_HIBERNATE_JDBC_TIME_ZONE=Asia/Seoul

# AI API 데이터베이스 설정
DATABASE_URL=postgresql://{{ postgres_user | default('lifebit_user') }}:{{ postgres_password | default('lifebit_password_prod_' + ansible_date_time.epoch) }}@postgres-db:5432/{{ postgres_db | default('lifebit_db') }}?connect_timeout=30&application_name=LifeBit-AI-API
DB_HOST=postgres-db
DB_PORT=5432
DB_NAME={{ postgres_db | default('lifebit_db') }}
DB_USER={{ postgres_user | default('lifebit_user') }}
DB_PASSWORD={{ postgres_password | default('lifebit_password_prod_' + ansible_date_time.epoch) }}