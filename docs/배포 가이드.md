# 🚀 LifeBit 자동 배포 설정 가이드

> 🚨 **잠깐! 이 설정을 하려면?**
>
> 이 가이드의 2번 단계(`GitHub 비밀금고에 열쇠 넣기`)를 진행하려면, **GitHub 저장소의 소유자(Owner) 또는 관리자(Admin) 권한**이 필요합니다.
> 만약 권한이 없다면, 저장소 관리자에게 이 문서를 전달하여 설정을 요청해주세요!

안녕하세요! 우리가 만든 멋진 LifeBit 프로젝트를 인터넷 세상에 공개하기 위한 모든 준비가 끝났어요.

이제부터 여러분이 할 일은 딱 한 가지, 우리가 만든 **'배포 로봇(GitHub Actions)'**에게 **'비밀 열쇠'**를 알려주는 거예요. 이 로봇은 여러분이 코드를 살짝만 고쳐도, 번개처럼 달려가서 모든 것을 자동으로 설치하고 배포해 줄 거랍니다!

## 🤖 배포 로봇에게 줘야 할 3가지 비밀 열쇠

로봇이 일을 하려면 AWS라는 나라에 들어갈 수 있는 **'출입증'**과, 그 나라에 있는 우리 서버 컴퓨터의 **'집 열쇠'**가 필요해요. 이 열쇠들은 아주 소중하니까, GitHub의 비밀금고(**Secrets**)에 안전하게 넣어줄 거예요.

### 1️⃣ 첫 번째: AWS 서버 '집 열쇠' 만들기 🔑

먼저 우리 서버 컴퓨터에 들어갈 수 있는 열쇠를 만들어야 해요.

1.  **AWS 홈페이지**에 로그인해서 **EC2 서비스**로 가주세요.
2.  왼쪽 메뉴에서 **'키 페어'**를 찾아서 클릭하세요.
3.  **'키 페어 생성'** 버튼을 누르고, 아래처럼 똑같이 만들어주세요.
    *   **이름**: `lifebit-key` (🚨 **아주 중요해요!** 이름이 다르면 로봇이 열쇠를 못 찾아요!)
    *   **키 페어 유형**: RSA
    *   **프라이빗 키 파일 형식**: `.pem`
4.  만들기를 누르면 `lifebit-key.pem` 파일이 컴퓨터에 다운로드될 거예요. 이 파일은 아무에게도 보여주면 안 되는 비밀 열쇠니까 잘 보관해주세요!

### 2️⃣ 두 번째: GitHub 비밀금고에 열쇠 넣기 🔐

이제 만든 열쇠들을 로봇만 볼 수 있는 GitHub의 비밀금고에 넣어줄 차례예요.
우리 LifeBit **GitHub 저장소**의 **Settings > Secrets and variables > Actions** 메뉴로 가서,
아래 목록에 있는 **모든 값들을** `New repository secret` 버튼을 눌러 하나씩 만들어주세요.

> ✨ **어디서 값을 찾나요?**
>
> `apps/frontend-vite/.env` 파일과 `apps/ai-api-fastapi/.env` 파일에 있는 값들을 복사해서 붙여넣으면 편리해요!

---

####  필수 배포용 비밀 키 (3개)

| Secret 이름           | 값 (Value)                                                                                             | 설명                        |
| --------------------- | ------------------------------------------------------------------------------------------------------ | --------------------------- |
| `AWS_ACCESS_KEY_ID`     | `여러분의 AWS 액세스 키 ID`                                                                               | AWS 접속용 ID               |
| `AWS_SECRET_ACCESS_KEY` | `여러분의 AWS 비밀 액세스 키`                                                                             | AWS 접속용 비밀번호         |
| `SSH_PRIVATE_KEY`       | `lifebit-key.pem` 파일의 내용 전체 (`-----BEGIN...` 부터 `...END-----` 까지)                             | EC2 서버 접속용 열쇠        |

#### 애플리케이션용 비밀 키 (4개)

| Secret 이름             | 값 (Value)                                                | 출처 파일 및 변수명                  |
| ----------------------- | --------------------------------------------------------- | ------------------------------------ |
| `OPENAI_API_KEY`        | `sk-....` 로 시작하는 키                                    | `ai-api-fastapi/.env` -> `OPENAI_API_KEY` |
| `JWT_SECRET_KEY`        | `default...` 로 시작하는 키 또는 원하는 비밀 문장         | `ai-api-fastapi/.env` -> `JWT_SECRET_KEY` |
| `GOOGLE_CLIENT_SECRET`  | `GOCSPX-...` 로 시작하는 시크릿                             | `ai-api-fastapi/.env` -> `GOOGLE_CLIENT_SECRET` |
| `KAKAO_CLIENT_ID`       | `6810...` 로 시작하는 ID                                  | `frontend-vite/.env` -> `VITE_KAKAO_CLIENT_ID` |
| `GOOGLE_CLIENT_ID`      | `3489...` 로 시작하는 ID                                  | `frontend-vite/.env` -> `VITE_GOOGLE_CLIENT_ID` |

---

### 3️⃣ 세 번째: 로봇 출발시키기! 🚀

자, 이제 로봇에게 모든 열쇠를 주었어요. 마지막으로 우리가 만든 모든 자동화 시스템 파일들을 GitHub에 올려주기만 하면 로봇이 **자동으로 서버를 켜고 최신 코드를 배포**할 거예요!

아래 명령어들을 터미널에 차례대로 입력해주세요.

```bash
# 1. 새로 만든 모든 파일들을 챙겨요.
git add .

# 2. "자동 배포 시스템 완성!" 이라고 이름표를 붙여줘요.
git commit -m "feat: Complete deployment automation system"

# 3. 로봇을 출발시켜요!
git push origin main
```

---

### 💡 서버를 켜고 끌 수 있는 '전원 스위치' 사용법

> "서버를 계속 켜두면 요금이 걱정돼요!"

걱정 마세요! 우리에겐 GitHub에 있는 '전원 스위치'가 있어요. 필요할 때만 서버를 켜고, 다 썼으면 서버를 꺼서 요금을 아낄 수 있답니다.

1.  우리 GitHub 저장소의 **'Actions'** 탭으로 가주세요.
2.  왼쪽 메뉴에서 **'Main Pipeline (Deploy / Destroy)'** 를 클릭해주세요.
3.  오른쪽 위에 **'Run workflow'** 라는 버튼이 보일 거예요. 그걸 클릭하세요.

#### ✅ 서버를 켜고 싶을 때 (Deploy)

*   `Action to perform...` 이라고 된 녹색 드롭다운 메뉴에서 **`deploy`** 를 선택하세요.
*   **'Run workflow'** 버튼을 누르세요.
*   그러면 배포 로봇이 깨어나서 AWS에 서버를 만들고, 모든 프로그램을 설치한 뒤, 최신 코드를 배포할 거예요.

#### ❌ 서버를 끄고 싶을 때 (Destroy)

*   `Action to perform...` 드롭다운 메뉴에서 **`destroy`** 를 선택하세요.
*   **'Run workflow'** 버튼을 누르세요.
*   그러면 배포 로봇이 AWS에 있는 서버, IP 주소, 디스크 등 모든 것을 **깨끗하게 삭제**해 줄 거예요.
*   **이 작업이 끝나면 더 이상 요금이 나오지 않아요!**

---

### 🤔 잘 되고 있는지 어떻게 확인하나요?

`git push` 명령을 실행한 뒤에, 우리 GitHub 저장소의 **'Actions'** 탭을 눌러보세요.

'Deploy to AWS EC2' 라는 이름의 로봇이 열심히 일하는 모습을 볼 수 있을 거예요. 모든 과정이 끝나고 초록색 체크 표시(✅)가 뜨면 배포에 성공한 거랍니다!

이제 인터넷 주소창에 서버의 IP 주소만 입력하면, 어디서든 우리의 LifeBit 프로젝트를 만날 수 있어요! (서버 IP 주소는 Actions 실행 결과 로그에서 확인할 수 있어요)

**이제 모든 준비가 끝났습니다. 정말 고생 많으셨어요!** 