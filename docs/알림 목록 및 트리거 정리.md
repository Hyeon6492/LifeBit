# LifeBit 프로젝트 알림 목록 및 트리거 정리

## 1. 랭킹 관련 알림
- **업적 달성 알림**
  - 운동 기록 시 자동 업적 체크 → 업적 달성 시 알림 생성
- **등급 변화 알림**
  - 랭킹 티어(등급) 업/다운 시 알림
- **순위 변동 알림**
  - 랭킹 순위가 변동될 때 알림
- **랭킹 시즌 종료/보상 알림**
  - 시즌 종료, 보상 지급 등 주요 이벤트

## 2. 건강 상태 모니터링 알림
- **과도한 운동 경고**
  - 주간 운동 시간이 기준(예: 5시간) 초과 시
- **주간 운동 목표 달성 알림**
- **연속 운동 일수 달성 알림**
  - 예: 7일 연속 운동
- **영양소 불균형 알림**
  - 영양소 섭취가 기준에 맞지 않을 때
- **수분 섭취 부족 알림**
  - 수분 섭취량이 부족할 때

## 3. 목표 관련 알림 (프로필/목표 설정)
- **목표 설정/수정 완료 알림**
- **목표 달성 임박 알림**
  - 목표 달성률이 90% 이상 등 임박 시

---

## 🔔 알림 생성 트리거(실제 데이터 기반)
- 운동 기록 저장 → 업적, 랭킹, 건강 알림 생성
- 식단 기록 저장 → 건강 상태 모니터링(영양소, 수분 등) 알림 생성
- 목표 설정/수정 → 목표 관련 알림 생성
- 랭킹 변동/시즌 종료 → 랭킹 알림 생성
- 주간/일간 목표 달성 → 목표 달성 알림 생성

> **실제 알림은 위 트리거가 발생해야 DB에 저장되고, 알림 벨에 표시됩니다.**

---

## ⚠️ 알림 읽음 처리 오류사항 및 해결방안

### 현재 발생 가능한 오류
1. **알림 클릭 시 읽음 처리 실패**
   - 네트워크 오류로 인한 읽음 처리 API 호출 실패
   - 백엔드 서버 응답 지연으로 인한 UI 업데이트 지연

2. **알림 목록 동기화 문제**
   - 읽음 처리 후 프론트엔드 상태 업데이트 지연
   - 여러 탭에서 동시 접근 시 알림 상태 불일치

3. **알림 삭제 후 UI 업데이트 오류**
   - 삭제된 알림이 UI에서 즉시 사라지지 않는 문제
   - 알림 개수 카운터 업데이트 지연

### 해결방안
1. **에러 핸들링 강화**
   ```typescript
   // 알림 읽음 처리 시 재시도 로직
   const markAsRead = async (notificationId: number) => {
     try {
       await markNotificationAsRead(notificationId);
       // 성공 시 UI 업데이트
     } catch (error) {
       console.error('알림 읽음 처리 실패:', error);
       // 사용자에게 재시도 옵션 제공
     }
   };
   ```

2. **낙관적 업데이트 적용**
   - 읽음 처리 API 호출 전에 UI를 먼저 업데이트
   - 실패 시 원래 상태로 롤백

3. **실시간 알림 상태 동기화**
   - WebSocket을 통한 실시간 알림 상태 업데이트
   - 주기적인 알림 목록 새로고침

4. **로컬 스토리지 백업**
   - 읽음 처리된 알림 ID를 로컬에 저장
   - 페이지 새로고침 시에도 읽음 상태 유지

### 권장사항
- 알림 관련 API 호출 시 로딩 상태 표시
- 네트워크 오류 시 사용자 친화적인 에러 메시지 제공
- 알림 읽음 처리 실패 시 자동 재시도 기능 구현
- 알림 상태 변경 시 즉시 UI 업데이트 보장

---

## 참고
- AI 채팅, 노트, 관리자, 회원정보 등은 아직 알림 미구현
- 테스트용 알림은 운동/식단 기록, 목표 설정/수정 등 실제 행동을 통해 생성 가능 



